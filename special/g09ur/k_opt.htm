<html><head><title>G09 Keyword: Opt</title></head><body>

<h1>Opt</h1>
<h3><font size="-1" color="#222222">DESCRIPTION</font></h3>
<p>This keyword requests that a geometry optimization be performed. The geometry will be adjusted until a stationary point on the potential surface is found. Analytic gradients will be used if available. For the Hartree-Fock, CIS, MP2, MP3, MP4(SDQ), CID, CISD, CCD, CCSD, QCISD, BD, CASSCF, and all DFT and semi-empirical methods, the default algorithm for both minimizations (optimizations to a local minimum) and optimizations to transition states and higher-order saddle points is the Berny algorithm using GEDIIS <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Li06" class="showTip Li06">Li06</a>]</font> in redundant internal coordinates <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Pulay79" class="showTip Pulay79">Pulay79</a>, <a href="refs.htm#Fogarasi92" class="showTip Fogarasi92">Fogarasi92</a>, <a href="refs.htm#Pulay92" class="showTip Pulay92">Pulay92</a>, <a href="refs.htm#Baker93" class="showTip Baker93">Baker93</a>, <a href="refs.htm#Peng93" class="showTip Peng93">Peng93</a>, <a href="refs.htm#Peng96" class="showTip Peng96">Peng96</a>]</font> (corresponding to the <b><font color="#0000FF">Redundant</font></b> option). An brief overview of the Berny algorithm is provided in the final subsection of this discussion. The default algorithm for all methods lacking analytic gradients is the eigenvalue-following algorithm (<a href="k_opt.htm"><b><font color="#0000FF">Opt=EF</font></b></a>).</p>
<p>Gaussian includes the STQN method for locating transition structures. This method, implemented by H. B. Schlegel and coworkers <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Peng93" class="showTip Peng93">Peng93</a>, <a href="refs.htm#Peng96" class="showTip Peng96">Peng96</a>]</font>, uses a quadratic synchronous transit approach to get closer to the quadratic region of the transition state and then uses a quasi-Newton or eigenvector-following algorithm to complete the optimization. Like the default algorithm for minimizations, it performs optimizations by default in redundant internal coordinates. This method will converge efficiently when provided with an empirical estimate of the Hessian and suitable starting structures.</p>
<p>This method is requested with the <b><font color="#0000FF">QST2</font></b> and <b><font color="#0000FF">QST3</font></b> options. <b><font color="#0000FF">QST2</font></b> requires two molecule specifications, for the reactants and products, as its input, while <b><font color="#0000FF">QST3</font></b> requires three molecule specifications: the reactants, the products, and an initial structure for the transition state, in that order. <font face="Times New Roman, Times, serif" size="3"><i>The order of the atoms must be identical within all molecule specifications</i></font>. See the examples for sample input for and output from this method.</p>
<p>Basic information as well as techniques and pitfalls related to geometry optimizations are discussed in detail in chapter 3 of <font face="Times New Roman, Times, serif" size="3"><i>Exploring Chemistry with Electronic Structure Methods</i></font> <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Foresman96b" class="showTip Foresman96b">Foresman96b</a>]</font>. For a review article on optimization and related subjects, see <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Hratchian05a" class="showTip Hratchian05a">Hratchian05a</a>]</font>.</p>
<h3><font size="-1" color="#222222">SELECTING THE OPTIMIZATION GOAL</font></h3>
<p>By default, optimizations search for a local minimum.</p>
<p><b><font color="#0000FF">QST2</font></b><br />
  Search for a transition structure using the STQN method. This option requires the reactant and product structures as input, specified in two consecutive groups of title and molecule specification sections. Note that the atoms must be specified in the same order in the two structures. <b><font color="#0000FF">TS</font></b> should <font face="Times New Roman, Times, serif" size="3"><i>not</i></font> be specified with <b><font color="#0000FF">QST2</font></b>. </p>
<p><b><font color="#0000FF">QST3</font></b><br />
  Search for a transition structure using the STQN method. This option requires the reactant, product, and initial TS structures as input, specified in three consecutive groups of title and molecule specification sections. Note that the atoms must be specified in the same order within the three structures. <b><font color="#0000FF">TS</font></b> should <font face="Times New Roman, Times, serif" size="3"><i>not</i></font> be specified with <b><font color="#0000FF">QST3</font></b>. </p>
<p><b><font color="#0000FF">TS</font></b><br />
  Requests optimization to a transition state rather than a local minimum, using the Berny algorithm. </p>
<p><b><font color="#0000FF">Saddle=<font face="Times New Roman, Times, serif" size="3"><i>N</i></font></font></b><br />
  Requests optimization to a saddle point of order <font face="Times New Roman, Times, serif" size="3"><i>N</i></font> using the Berny algorithm. </p>
<p><b><font color="#0000FF">Conical</font></b><br />
  Search for a conical intersection or avoided crossing using the state-averaged CASSCF method. <b><font color="#0000FF">Avoided</font></b> is a synonym for <b><font color="#0000FF">Conical</font></b>. Note that <a href="k_casscf.htm"><b><font color="#0000FF">CASSCF=SlaterDet</font></b></a> is needed in order to locate a conical intersection between a singlet state and a triplet state. </p>
<h3><font size="-1" color="#222222">OPTIONS TO MODIFY THE INITIAL GEOMETRY</font></h3>
<p><b><font color="#0000FF">ModRedundant</font></b><br />
  Add, delete or modify redundant internal coordinate definitions (including scan and constraint information) before performing the calculation. This option requires a separate input section following the geometry specification. When used in conjunction with <b><font color="#0000FF">QST2</font></b> or <b><font color="#0000FF">QST3</font></b>, a <b><font color="#0000FF">ModRedundant</font></b> input section must follow each geometry specification. <b><font color="#0000FF">AddRedundant</font></b> is synonymous with <b><font color="#0000FF">ModRedundant</font></b>. </p>

<p>Lines in a <b><font color="#0000FF">ModRedundant</font></b> input section use the following syntax:</p>
<pre>
[<font face="Times New Roman, Times, serif" size="3"><i>Type</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>1 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>2 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>3 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>4]]]&nbsp;[<b><font color="#0000FF">A</font></b> | <b><font color="#0000FF">F</font></b>]&nbsp;[[<font face="Times New Roman, Times, serif" size="3"><i>min</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>max</i></font>]]
[<font face="Times New Roman, Times, serif" size="3"><i>Type</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>1 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>2 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>3 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>4]]] <b><font color="#0000FF">B</font></b> [[<font face="Times New Roman, Times, serif" size="3"><i>min</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>max</i></font>]]
[<font face="Times New Roman, Times, serif" size="3"><i>Type</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>1 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>2 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>3 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>4]]] <b><font color="#0000FF">K</font></b>|<b><font color="#0000FF">R</font></b> [[<font face="Times New Roman, Times, serif" size="3"><i>min</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>max</i></font>]]
[<font face="Times New Roman, Times, serif" size="3"><i>Type</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>1 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>2 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>3 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>4]]] <b><font color="#0000FF">D</font></b> [[<font face="Times New Roman, Times, serif" size="3"><i>min</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>max</i></font>]]
[<font face="Times New Roman, Times, serif" size="3"><i>Type</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>1 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>2 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>3 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>4]]] <b><font color="#0000FF">H</font></b> <font face="Times New Roman, Times, serif" size="3"><i>diag-elem</i></font> [[<font face="Times New Roman, Times, serif" size="3"><i>min</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>max</i></font>]]
[<font face="Times New Roman, Times, serif" size="3"><i>Type</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>1 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>2 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>3 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>4]]] <b><font color="#0000FF">S</font></b> <font face="Times New Roman, Times, serif" size="3"><i>nsteps stepsize</i></font> [[<font face="Times New Roman, Times, serif" size="3"><i>min</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>max</i></font>]]
</pre>
<p><font face="Times New Roman, Times, serif" size="3"><i>N</i></font>1, <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>2, <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>3 and <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>4 are atom numbers or wildcards (discussed below). Atom numbering begins at 1, and any dummy atoms are not counted.<br />
  <br />
  The atom numbers  are followed by a one-character code letter indicating the coordinate modification to be performed; the action code is sometimes followed by additional required parameters as indicated above. If no action code is included, the default action is to add the specified coordinate. These are the available action codes:</p>
<table border="0" cellpadding="2">
  <tr valign="top">
    <td><b><font color="#0000FF">A</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Activate the coordinate for optimization if it has been frozen.</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">F</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Freeze the coordinate in the optimization.</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">B</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Add the coordinate and build all related coordinates.</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">K</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Remove the coordinate and kill all related coordinates containing this coordinate.</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">R</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Remove the coordinate from the definition list (but not the related coordinates).</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">D</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Calculate numerical second derivatives for the row and column of the initial Hessian for this coordinate.</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">H</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Change the diagonal element for this coordinate in the initial Hessian to <font face="Times New Roman, Times, serif" size="3"><i>diag-elem</i></font>.</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">S</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Perform a relaxed potential energy surface scan. Increment the coordinate by <font face="Times New Roman, Times, serif" size="3"><i>stepsize</i></font> a total of <font face="Times New Roman, Times, serif" size="3"><i>nsteps</i></font> times, performing an optimization from each resulting starting geometry.</td>
  </tr>
</table>
<p>An asterisk (*) in the place of an atom number indicates a wildcard. <font face="Times New Roman, Times, serif" size="3"><i>Min</i></font> and <font face="Times New Roman, Times, serif" size="3"><i>max</i></font> only apply to coordinate specifications containing wildcards. The action then specified by the action code is taken only if the value of the coordinate is in the <em>min</em>&ndash;<em>max</em> range (or below maximum value if <em>min</em> is not given). <br />
  <br />
  Here are some examples of wildcard use:</p>
<table border="0" cellpadding="2">
  <tr valign="top">
    <td><b><font color="#0000FF">*</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>All atoms specified by Cartesian coordinates</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">* *</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>All defined bonds</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">3 *</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>All defined bonds with atom 3</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">* * *</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>All defined valence angles</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">* 4 *</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>All defined valence angles around atom 4</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">* * * *</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>All defined dihedral angles</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">* 3 4 *</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>All defined dihedral angles around the bond connecting atoms 3 and 4</td>
  </tr>
</table>
<p>By default, the coordinate type is determined from the number of atoms specified: Cartesian coordinates for 1 atom, bond stretch for 2 atoms, valence angle for 3 atoms and dihedral angle for 4 atoms. Optionally, <font face="Times New Roman, Times, serif" size="3"><i>type</i></font> can be used to designate these and additional coordinate types:</p>
<table border="0" cellpadding="2">
  <tr valign="top">
    <td><b><font color="#0000FF">X</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Cartesian coordinates.</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">B</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Bond length</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">A</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Valence angle</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">D</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Dihedral angle</td>
  </tr>
  <tr valign="top">
    <td><b><font color="#0000FF">L</font></b></td>
    <td>&nbsp;&nbsp;</td>
    <td>Linear bend specified by three atoms (if <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>4 is <b><font color="#0000FF">-1</font></b>) or by four atoms, where the fourth atom is used to determine the 2 orthogonal directions of the linear bend. In this case, <font face="Times New Roman, Times, serif" size="3"><i>min</i></font> and <font face="Times New Roman, Times, serif" size="3"><i>max</i></font> are each pairs of numbers, specifying the two orthogonal bending components.</td>
  </tr>
  
</table>
<p>By default, redundant internal coordinates for potential hydrogen bonds are not generated automatically. However, bond coordinates are still added to connect otherwise disjoint fragments, so coordinates for hydrogen bonds which connect fragments will still be included.</p>
<p>See the examples later in this section for illustrations of the use of <b><font color="#0000FF">ModRedundant</font></b>.</p>
<p><b><font color="#0000FF">ReadOptimize</font></b><br />
  Read an input section modifying which atoms are to be optimized. The atom list is specified in a separate input section (terminated by a blank line). By default, the atom list contains all atoms in the molecule, unless any atoms are designated as frozen within the molecule specification, in which case the initial atom list excludes them. If the structure is being read in from the checkpoint file, then the list of atoms to be optimized matches that in the checkpoint file.<b><font color="#0000FF"> ReadOpt</font></b> and <b><font color="#0000FF">RdOpt</font></b> are synonyms for this option.</b> <b><font color="#0000FF">ReadFreeze</font></b> is a deprecated synonym.<br />
  <br />
  The input section uses the following format: </p>
<pre>
atoms=<font face="Times New Roman, Times, serif" size="3"><i>list</i></font> [notatoms=<font face="Times New Roman, Times, serif" size="3"><i>list</i></font>]
</pre>
<p>where each <font face="Times New Roman, Times, serif" size="3"><i>list</i></font> is a comma or space-separated list of atom numbers, atom number ranges and/or atom types. Keywords are applied in succession. Here are some examples:</p>
<pre>
atoms=3-6,17&nbsp;notatoms=5 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Adds atoms 3, 4, 6 and 17 to the atom list. Removes 5 if present.</i></font></font>
atoms=3 C 18-30&nbsp;notatoms=H &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Adds all C &amp; non-H among atoms 3, 18-30.</i></font></font>
atoms=C N&nbsp;notatoms=5 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Adds all C and N atoms except atom 5.</i></font></font>
atoms=1-5&nbsp;notatoms=H&nbsp;atoms=8-10 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Adds non-hydrogens among atoms 1-5,</i></font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>and atoms 8-10 regardless of element type.</i></font></font>
</pre>
<p>Bare integers without a keyword are interpreted as atom numbers:</p>
<pre>
1,3,5 7 &nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Adds atoms 1, 3, 5 and 7.</i></font></font>
</pre>
<p>For ONIOM optimizations only, <b><font color="#0000FF">block</font></b> and <b><font color="#0000FF">notblock</font></b> can be similarly used to include/exclude rigid blocks defined in ONIOM molecule specifications. If there are contradictions between atoms specified as atoms and within blocks&mdash;e.g., an atom is included within a block but excluded by atom type&mdash;Gaussian 09 generates an error. <br />
  <br />
  You can start from an empty atom list by placing <b><font color="#0000FF">noatoms</font></b> as the first item in the input section. For example, the following input optimizes all non-hydrogen atoms within atoms 1-100 and  freezes all other atoms in the molecule:</p>
<pre>
noatoms atoms=1-100 notatoms=H
</pre>
<p>Atoms can also be specified by ONIOM layer via the [<b><font color="#0000FF">not</font></b>]<b><font color="#0000FF">layer</font></b> keywords, which accept these values: <b><font color="#0000FF">real</font></b> for the real system, <b><font color="#0000FF">model</font></b> for the model system in a 2-layer ONIOM, <b><font color="#0000FF">middle</font></b> for the middle layer in a 3-layer ONIOM, and <b><font color="#0000FF">small</font></b> for the model layer of a 3-layer ONIOM. Atoms may be similarly included/excluded by residue with <b><font color="#0000FF">residue</font></b> and <b><font color="#0000FF">notresidue</font></b>, which accept lists of residue names. Both keyword pairs function as shorthand forms for atom lists. <br />
  <br />
  Separate sections are read for each geometry for transition state optimizations using <b><font color="#0000FF">QST2</font></b> or <b><font color="#0000FF">QST3</font></b>. Be aware that providing contradictory input&mdash;e.g., different frozen atoms for the reactants and products&mdash;will produce unpredictable results. <br />
</p>
<p><b><font color="#0000FF">NoFreeze</font></b><br />
  Activates (unfreezes) all variables, in other words freeze nothing and optimize all atoms. This option is useful when reading in a structure from a checkpoint file that contains frozen atoms (i.e. with <a href="k_geom.htm"><b><font color="#0000FF">Geom=Check</font></b></a>).</p>
<h3><font size="-1" color="#222222">GENERAL PROCEDURAL OPTIONS</font></h3>
<p><b><font color="#0000FF">MaxCycles=<font face="Times New Roman, Times, serif" size="3"><i>N</i></font></font></b><br />
  Sets the maximum number of optimization steps to <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>. The default is the maximum of 20 and twice the number of redundant internal coordinates in use (for the default procedure) or twice the number of variables to be optimized (for other procedures). </p>
<p><b><font color="#0000FF">MaxStep=<font face="Times New Roman, Times, serif" size="3"><i>N</i></font></font></b><br />
  Sets the maximum size for an optimization step (the initial trust radius) to 0.01<font face="Times New Roman, Times, serif" size="3"><i>N</i></font> Bohr or radians. The default value for <font face="Times New Roman, Times, serif" size="3"><i>N</i></font> is 30. </p>
<p><b><font color="#0000FF">Restart</font></b><br />
  Restarts a geometry optimization from the checkpoint file. In this case, the entire route section will consist of the <a href="k_opt.htm"><b><font color="#0000FF">Opt</font></b></a> keyword and the same options to it as specified for the original job (along with <a href="k_restart.htm"><b><font color="#0000FF">Restart</font></b></a>). No other input is needed (see the examples). </p>
<p><b><font color="#0000FF">InitialHarmonic=<font face="Times New Roman, Times, serif" size="3"><i>N</i></font></font></b><br />
  Add harmonic constraints to the initial structure with force constant <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>/1000000 Hartree/Bohr<sup>2</sup>. <b><font color="#0000FF">IHarmonic</font></b> is a synonym for this option. </p>
<p><b><font color="#0000FF">ChkHarmonic=<font face="Times New Roman, Times, serif" size="3"><i>N</i></font></font></b><br />
  Add harmonic constraints to the initial structure saved on the chk file with force constant <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>/1000000 Hartree/Bohr<sup>2</sup>. <b><font color="#0000FF">CHarmonic</font></b> is a synonym for this option. </p>
<p><b><font color="#0000FF">ReadHarmonic=<font face="Times New Roman, Times, serif" size="3"><i>N</i></font></font></b><br />
  Add harmonic constraints to a structure read in the input stream (in the input orientation), with force constant <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>/1000000 Hartree/Bohr<sup>2</sup>. <b><font color="#0000FF">RHarmonic</font></b> is a synonym for this option. </p>
<p><b><font color="#0000FF">MaxMicroiterations=<font face="Times New Roman, Times, serif" size="3"><i>N</i></font></font></b><br /> 
  Allow up to <em>N</em> microiterations. The default is based on <em>N</em>Atoms but is at least 5000. <b><font color="#0000FF">MaxMicro</font></b> is a synonym for this option.</p>
<p><b><font color="#0000FF">NGoDown=<font face="Times New Roman, Times, serif" size="3"><i>N</i></font></font></b><br />
  Mix at most <em>N</em> Hessian eigenvectors having negative eigenvalues when trying to go downhill. Defaults to 3. If <em>N</em>=-1, do regular RFO step only. <b><font color="#0000FF">NoDownHill </font></b>is equivalent to <b><font color="#0000FF">NGoDown = -1</font></b>.  <br />
</p>
<h3><font size="-1" color="#222222">OPTIONS RELATED TO INITIAL FORCE CONSTANTS</font></h3>
<p>Unless you specify otherwise, a Berny geometry optimization starts with an initial guess for the second derivative matrix&mdash;also known as the Hessian&mdash;which is determined using connectivity derived from atomic radii and a simple valence force field <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Schlegel84a" class="showTip Schlegel84a">Schlegel84a</a>, <a href="refs.htm#Peng96" class="showTip Peng96">Peng96</a>]</font>. The approximate matrix is improved at each point using the computed first derivatives. This scheme usually works fine, but for some cases the initial guess may be so poor that the optimization fails to start off properly or spends many early steps improving the Hessian without nearing the optimized structure. In addition, for optimizations to transition states, some knowledge of the curvature around the saddle point is essential, and the default approximate Hessian must always be improved.</p>
<p>The following options select methods for providing improved force constants:</p>
<p><b><font color="#0000FF">ReadFC</font></b><br />
Extract force constants from a checkpoint file. These will typically be the final approximate force constants from an optimization at a lower level, or (much better) the force constants computed correctly by a lower-level frequency calculation (the latter are greatly preferable to the former).
</p>
<p><b><font color="#0000FF">CalcFC</font></b><br />
Specifies that the force constants be computed at the first point using the current method (available for the HF, MP2, CASSCF, DFT, CIS, and semi-empirical methods only).
</p>
<p><b><font color="#0000FF">CalcHFFC</font></b><br />
Specifies that the analytic HF force constants are to be computed at the first point. <b><font color="#0000FF">CalcHFFC</font></b> is used with MP2 optimizations, and it is equivalent to <b><font color="#0000FF">CalcFC</font></b> for DFT methods, AM1, PM3, PM3MM, PM6 and PDDG.</p>
<p><b><font color="#0000FF">RCFC</font></b><br />
Specifies that the computed force constants in Cartesian coordinates (as opposed to internal) from a frequency calculation are to be read from the checkpoint file. Normally it is preferable to pick up the force constants already converted to internal coordinates as described above (<b><font color="#0000FF">CalcFC</font></b>). However, a frequency calculation occasionally reveals that a molecule needs to distort to lower symmetry. In this case, the computed force constants in terms of the old internal coordinates cannot be used, and instead <a href="k_opt.htm"><b><font color="#0000FF">Opt=RCFC</font></b></a> is used to read the Cartesian force constants and transform them. Note that Cartesian force constants are only available on the checkpoint file after a frequency calculation. You cannot use this option after an optimization dies because of a wrong number of negative eigenvalues in the approximate second derivative matrix. In the latter case, you may want to start from the most recent geometry and compute some derivatives numerically (see below). <b><font color="#0000FF">ReadCartesianFC</font></b> is a synonym for <b><font color="#0000FF">RCFC</font></b>.
</p>
<p><b><font color="#0000FF">CalcAll</font></b><br />
Specifies that the force constants are to be computed at every point using the current method (available for the HF, MP2, CASSCF, DFT, CIS, and semi-empirical methods only). Note that vibrational frequency analysis is automatically done at the converged structure and the results of the calculation are archived as a frequency job.
</p>
<p><b><font color="#0000FF">VCD</font></b><br />
Calculate VCD intensities at each point of a Hartree-Fock or DFT <a href="k_opt.htm"><b><font color="#0000FF">Opt=CalcAll</font></b></a> optimization.
</p>
<p><b><font color="#0000FF">NoRaman</font></b><br />
Specifies that Raman intensities are not to be calculated at each point of a Hartree-Fock <a href="k_opt.htm"><b><font color="#0000FF">Opt=CalcAll</font></b></a> job (since it includes a frequency analysis using the results of the final point of the optimization). The Raman intensities add 10-20% to the cost of each intermediate second derivative point.
</p>
<p>There are two other approaches to providing the initial Hessian which are sometimes useful:</p>
<ul>
<li>
<p><b>Input new guesses</b>: The default approximate matrix can be used, but with new guesses read in for some or all of the diagonal elements of the Hessian. This is specified in the <b><font color="#0000FF">ModRedundant</font></b> input or on the variable definition lines in the Z-matrix. For example:</p>
<pre>
1 2 H 0.55
</pre>
<p>The letter <b><font color="#0000FF">H</font></b> indicates that a diagonal force constant is being specified for this coordinate and that its value is 0.55 Hartree/au<sup>2</sup>.</p>
</li>
<li>
<p><b>Compute some or all of the Hessian numerically</b>: You can ask the optimization program to compute part of the second derivative matrix numerically. In this case each specified variable will be stepped in only one direction, not both up and down as would be required for an accurate determination of force constants. The resulting second-derivatives are not as good as those determined by a frequency calculation but are fine for starting an optimization. Of course, this requires that the program do an extra gradient calculation for each specified variable. This procedure is requested by a flag (<b><font color="#0000FF">D</font></b>) on the variable definition lines:</p>
<pre>
1 2 D
1 2 3 D </pre>
<p>This input tells the program to do three points before taking the first optimization step: the usual first point, a geometry with the bond between atoms 1 and 2 incremented slightly, and a geometry with the angle between atoms 1, 2 and 3 incremented slightly. The program will estimate all force constants (on and off diagonal) for bond(1,2) and angle(1,2,3) from the three points. This option is only available with the Berny and EF algorithms.</p>
</li></ul>
<p><b><font color="#0000FF">StarOnly</font></b><br />
Specifies that the specified force constants are to be estimated numerically but that no optimization is to be done. Note that this has nothing to do with computation of vibrational frequencies.
</p>
<p><b><font color="#0000FF">NewEstmFC</font></b><br />
Estimate the force constants using a valence force field. This is the default.
</p>
<p><b><font color="#0000FF">EstmFC</font></b><br />
Estimate the force constants using the old diagonal guesses. Only available for the Berny algorithm.
</p>
<h3><font size="-1" color="#222222">CONVERGENCE-RELATED OPTIONS</font></h3>
<p>These options are available for the Berny algorithm only.</p>
<p><b><font color="#0000FF">Tight</font></b><br />
This option tightens the cutoffs on forces and step size that are used to determine convergence. An optimization with <a href="k_opt.htm"><b><font color="#0000FF">Opt=Tight</font></b></a> will take several more steps than with the default cutoffs. For molecular systems with very small force constants (low frequency vibrational modes), this may be necessary to ensure adequate convergence and reliability of frequencies computed in a subsequent job step. This option can only be used with Berny optimizations. For DFT calculations, <b><font color="#0000FF">Int=UltraFine</font></b> should be specified as well.
</p>
<p><b><font color="#0000FF">VeryTight</font></b><br />
Extremely tight optimization convergence criteria. <b><font color="#0000FF">VTight</font></b> is a synonym for <b><font color="#0000FF">VeryTight</font></b>. For DFT calculations, <b><font color="#0000FF">Int=UltraFine</font></b> should be specified as well.
</p>
<p><b><font color="#0000FF">EigenTest</font></b><br />
<b><font color="#0000FF">EigenTest</font></b> requests and <b><font color="#0000FF">NoEigenTest</font></b> suppresses testing the curvature in Berny optimizations. The test is on by default only for transition states in internal (Z-matrix) or Cartesian coordinates, for which it is recommended. Occasionally, transition state optimizations converge even if the test is not passed, but <b><font color="#0000FF">NoEigenTest</font></b> is only recommended for those with large computing budgets.
</p>
<p><b><font color="#0000FF">Expert</font></b><br />
Relaxes various limits on maximum and minimum force constants and step sizes enforced by the Berny program. This option can lead to faster convergence but is quite dangerous. It is used by experts in cases where the forces and force constants are very different from typical molecules and Z-matrices, and sometimes in conjunction with <a href="k_opt.htm"><b><font color="#0000FF">Opt=CalcFC</font></b></a> or <a href="k_opt.htm"><b><font color="#0000FF">Opt=CalcAll</font></b></a>. <b><font color="#0000FF">NoExpert</font></b> enforces the default limits and is the default.
</p>
<p><b><font color="#0000FF">Loose</font></b><br />
Sets the optimization convergence criteria to a maximum step size of 0.01 au and an RMS force of 0.0017 au. These values are consistent with the <b><font color="#0000FF">Int(Grid=SG1)</font></b> keyword, and may be appropriate for initial optimizations of large molecules using DFT methods which are intended to be followed by a full convergence optimization using the default (<b><font color="#0000FF">Fine</font></b>) grid. It is <font face="Times New Roman, Times, serif" size="3"><i>not</i></font> recommended for use by itself.
</p>
<h3><font size="-1" color="#222222">ALGORITHM-RELATED OPTIONS</font></h3>
<p><b><font color="#0000FF">GEDIIS</font></b><br />
Use <b><font color="#0000FF">GEDIIS</font></b> optimization algorithm. This is the default for minimizations when gradients are available.
</p>
<p><b><font color="#0000FF">RFO</font></b><br />
Requests the Rational Function Optimization <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Simons83" class="showTip Simons83">Simons83</a>]</font> step during Berny optimizations. It is the default for transition state optimizations (<a href="k_opt.htm"><b><font color="#0000FF">Opt=TS</font></b></a>). This was also the default algorithm for minimizations using gradients in Gaussian 03.
</p>
<p><b><font color="#0000FF">EF</font></b><br />
Requests an eigenvalue-following algorithm <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Cerjan81" class="showTip Cerjan81">Cerjan81</a>, <a href="refs.htm#Simons83" class="showTip Simons83">Simons83</a>, <a href="refs.htm#Banerjee85" class="showTip Banerjee85">Banerjee85</a>]</font>, which is useful only for methods without derivatives (for which it is the default). Available for both minima and transition states. and <b><font color="#0000FF">EigenvalueFollow</font></b> are all synonyms for <b><font color="#0000FF">EF</font></b>. When used with <a href="k_opt.htm"><b><font color="#0000FF">Opt=Z-Matrix</font></b></a>, a maximum of 50 variables may be optimized.
</p>
<h3><font size="-1" color="#222222">ONIOM-RELATED OPTIONS</font></h3>
<p><b><font color="#0000FF">Micro</font></b><br />
Use microiterations in ONIOM(MO:MM) optimizations. This is the default, with selection of L120 or L103 for the microiterations depending on whether electronic embedding is on or off. <b><font color="#0000FF">NoMicro</font></b> forbids microiterations during ONIOM(MO:MM) optimizations. <b><font color="#0000FF">Mic120</font></b> says to use microiterations in L120 for ONIOM(MO:MM), even for mechanical embedding. This is the default for electronic embedding. <b><font color="#0000FF">Mic103</font></b> says to perform microiterations in L103 for ONIOM(MO:MM). It is the default for mechanical embedding, and it cannot be used with electronic embedding.
</p>
<p><b><font color="#0000FF">QuadMacro</font></b><br />
Controls whether the coupled, quadratic macro step is used during ONIOM(MO:MM) geometry optimizations <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Vreven06a" class="showTip Vreven06a">Vreven06a</a>]</font>. <b><font color="#0000FF">NoQuadMacro</font></b> is the default.
</p>
<h3><font size="-1" color="#222222">COORDINATE SYSTEM SELECTION OPTIONS</font></h3>
<p><b><font color="#0000FF">Redundant</font></b><br />
Perform the optimization using the Berny algorithm in redundant internal coordinates. This is the default for methods for which analytic gradients are available.
</p>
<p><b><font color="#0000FF">Z-matrix</font></b><br />
Perform the optimization with the Berny algorithm using internal coordinates <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Schlegel82" class="showTip Schlegel82">Schlegel82</a>, <a href="refs.htm#Schlegel89" class="showTip Schlegel89">Schlegel89</a>, <a href="refs.htm#Schlegel95" class="showTip Schlegel95">Schlegel95</a>]</font>. In this case, the keyword <a href="k_opt.htm"><b><font color="#0000FF">FOpt</font></b></a> rather than <a href="k_opt.htm"><b><font color="#0000FF">Opt</font></b></a> requests that the program verify that a full optimization is being done (i.e., that the variables including inactive variables are linearly independent and span the degrees of freedom allowed by the molecular symmetry). The <a href="k_opt.htm"><b><font color="#0000FF">POpt</font></b></a> form requests a partial optimization in internal coordinates. It also suppresses the frequency analysis at the end of optimizations which include second derivatives at every point (via the <b><font color="#0000FF">CalcAll</font></b> option). See <a href="c_zmat.htm"><font color="#006699">Appendix C</font></a> for details and examples of Z-matrix molecule specifications.
</p>
<p><b><font color="#0000FF">Cartesian</font></b><br />
Requests that the optimization be performed in Cartesian coordinates, using the Berny algorithm. Note that the initial structure may be input using any coordinate system. No partial optimization or freezing of variables can be done with purely Cartesian optimizations; the mixed optimization format with all atoms specified via Cartesian lines in the Z-matrix can be used along with <a href="k_opt.htm"><b><font color="#0000FF">Opt=Z-matrix</font></b></a> if these features are needed. When a Z-matrix without any variables is used for the molecule specification, and <a href="k_opt.htm"><b><font color="#0000FF">Opt=Z-matrix</font></b></a> is specified, then the optimization will actually be performed in Cartesian coordinates. Note that a variety of other coordinate systems, such as distance matrix coordinates, can be constructed using the <b><font color="#0000FF">ModRedundant</font></b> option.
</p>
<h3><font size="-1" color="#222222">RARELY USED OPTIONS</font></h3>
<p><b><font color="#0000FF">Path=<font face="Times New Roman, Times, serif" size="3"><i>M</i></font></font></b><br />
In combination with either the <b><font color="#0000FF">QST2</font></b> or the <b><font color="#0000FF">QST3</font></b> option, requests the simultaneous optimization of a transition state and an <font face="Times New Roman, Times, serif" size="3"><i>M</i></font>-point reaction path in redundant internal coordinates <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Ayala97" class="showTip Ayala97">Ayala97</a>]</font>. No coordinate may be frozen during this type of calculation.
<br /><br />If <b><font color="#0000FF">QST2</font></b> is specified, the title and molecule specification sections for both reactant and product structures are required as input as usual. The remaining <font face="Times New Roman, Times, serif" size="3"><i>M</i></font>-2 points on the path are then generated by linear interpolation between the reactant and product input structures. The highest energy structure becomes the initial guess for the transition structure. Each point is optimized to lie in the reaction path and the highest point is optimized toward the transition structure.
<br /><br />If <b><font color="#0000FF">QST3</font></b> is specified, a third set of title and molecule specification sections must be included in the input as a guess for the transition state as usual. The remaining <font face="Times New Roman, Times, serif" size="3"><i>M</i></font>-3 points on the path are generated by two successive linear interpolations, first between the reactant and transition structure and then between the transition structure and product. By default, the central point is optimized to the transition structure, regardless of the ordering of the energies. In this case, <font face="Times New Roman, Times, serif" size="3"><i>M</i></font> must be an odd number so that the points on the path may be distributed evenly between the two sides of the transition structure.
<br /><br />In the output for a simultaneous optimization calculation, the predicted geometry for the optimized transition structure is followed by a list of all <font face="Times New Roman, Times, serif" size="3"><i>M</i></font> converged reaction path structures.
<br /><br />The treatment of the input reactant and product structures is controlled by other options: <b><font color="#0000FF">OptReactant</font></b>, <b><font color="#0000FF">OptProduct</font></b>, <b><font color="#0000FF">BiMolecular</font></b>.
<br /><br />Note that the SCF wavefunction for structures in the reactant valley may be quite different from that of structures in the product valley. <a href="k_guess.htm"><b><font color="#0000FF">Guess=Always</font></b></a> can be used to prevent the wavefunction of a reactant-like structure from being used as a guess for the wavefunction of a product-like structure.
</p>
<p><b><font color="#0000FF">OptReactant</font></b><br />
Specifies that the input structure for the reactant in a path optimization calculation (<a href="k_opt.htm"><b><font color="#0000FF">Opt=Path</font></b></a>) should be optimized to a local minimum. This is the default. <b><font color="#0000FF">NoOptReactant</font></b> retains the input structure as a point that is already on the reaction path (which generally means that it should have been previously optimized to a minimum). <b><font color="#0000FF">OptReactant</font></b> may not be combined with <b><font color="#0000FF">BiMolecular</font></b>.
</p>
<p><b><font color="#0000FF">BiMolecular</font></b><br />
Specifies that the reactants or products are bimolecular and that the input structure will be used as an anchor point in an <a href="k_opt.htm"><b><font color="#0000FF">Opt=Path</font></b></a> optimization. This anchor point will not appear as one of the <font face="Times New Roman, Times, serif" size="3"><i>M</i></font> points on the path. Instead, it will be used to control how far the reactant side spreads out from the transition state. By default, this option is off.
</p>
<p><b><font color="#0000FF">OptProduct</font></b><br />
Specifies that the input structure for the product in a path optimization calculation (<a href="k_opt.htm"><b><font color="#0000FF">Opt=Path</font></b></a>) should be optimized to a local minimum. This is the default. <b><font color="#0000FF">NoOptProduct</font></b> retains the input structure as a point that is already on the reaction path (which generally means that it should have been previously optimized to a minimum). <b><font color="#0000FF">OptProduct</font></b> may not be combined with <b><font color="#0000FF">BiMolecular</font></b>.
</p>
<p><b><font color="#0000FF">Linear</font></b><br />
<b><font color="#0000FF">Linear</font></b> requests and <b><font color="#0000FF">NoLinear</font></b> suppresses the linear search in Berny optimizations. The default is to use the linear search whenever possible.
</p>
<p><b><font color="#0000FF">TrustUpdate</font></b><br />
<b><font color="#0000FF">TrustUpdate</font></b> requests and <b><font color="#0000FF">NoTrustUpdate</font></b> suppresses dynamic update of the trust radius in Berny optimizations. The default is to update for minima.
</p>
<p><b><font color="#0000FF">Newton</font></b><br />
Use the Newton-Raphson step rather than the RFO step during Berny optimizations.
</p>
<p><b><font color="#0000FF">NRScale</font></b><br />
<b><font color="#0000FF">NRScale</font></b> requests that if the step size in the Newton-Raphson step in Berny optimizations exceeds the maximum, then it is to be scaled back. <b><font color="#0000FF">NoNRScale</font></b> causes a minimization on the surface of the sphere of maximum step size <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Golab83" class="showTip Golab83">Golab83</a>]</font>. Scaling is the default for transition state optimizations and minimizing on the sphere is the default for minimizations.
</p>
<p><b><font color="#0000FF">Steep</font></b><br />
Requests steepest descent instead of Newton-Raphson steps during Berny optimizations. This is only compatible with Berny local minimum optimizations. It may be useful when starting far from the minimum, but is unlikely to reach full convergence.
</p>
<p><b><font color="#0000FF">UpdateMethod=<font face="Times New Roman, Times, serif" size="3"><i>keyword</i></font></font></b><br />
Specifies the Hessian update method. <font face="Times New Roman, Times, serif" size="3"><i>Keyword</i></font> is one of: <b><font color="#0000FF">Powell</font></b>, <b><font color="#0000FF">BFGS</font></b>, <b><font color="#0000FF">PDBFGS</font></b>, <b><font color="#0000FF">ND2Corr</font></b>, <b><font color="#0000FF">OD2Corr</font></b>, <b><font color="#0000FF">D2CorrBFGS</font></b>, <b><font color="#0000FF">Bofill</font></b>, <b><font color="#0000FF">D2CMix</font></b> and <b><font color="#0000FF">None</font></b>.
</p>
<p><b><font color="#0000FF">HFError</font></b><br />
Assume that numerical errors in the energy and forces are those appropriate for HF and post-SCF calculations (1.0D-07 and 1.0D-07, respectively). This is the default for optimizations using those methods and also for semi-empirical methods.
</p>
<p><b><font color="#0000FF">FineGridError</font></b><br />
Assume that numerical errors in the energy and forces are those appropriate for DFT calculations using the default grid (1.0D-07 and 1.0D-06, respectively). This is the default for optimizations using a DFT method and using the default grid (or specifying <b><font color="#0000FF">Int=FineGrid</font></b>).
</p>
<p><b><font color="#0000FF">SG1Error</font></b><br />
Assume that numerical errors in the energy and forces are those appropriate for DFT calculations using the SG-1 grid (1.0D-07 and 1.0D-05, respectively). This is the default for optimizations using a DFT method and <b><font color="#0000FF">Int(Grid=SG1Grid)</font></b>. </p>
<h3><font size="-1" color="#222222">AVAILABILITY</font></h3>
<p>Analytic gradients are available for the HF, all DFT methods, CIS, MP2, MP3, MP4(SDQ), CID, CISD, CCD, CCSD, QCISD, CASSCF, and all semi-empirical methods.</p>
<p>The <b><font color="#0000FF">Tight</font></b>, <b><font color="#0000FF">VeryTight</font></b>, <b><font color="#0000FF">Expert</font></b>, <b><font color="#0000FF">Eigentest</font></b> and <b><font color="#0000FF">EstmFC</font></b> options are available for the Berny algorithm only.</p>
<p>Optimizations of large molecules which have many very low frequency vibrational modes with DFT will often proceed more reliably when a larger DFT integration grid is requested (<b><font color="#0000FF">Int=UltraFine</font></b>).</p>
<h3><font size="-1" color="#222222">RELATED KEYWORDS</font></h3>
<p><a href="k_irc.htm"><b><font color="#0000FF">IRC</font></b></a>, <a href="k_ircmax.htm"><b><font color="#0000FF">IRCMax</font></b></a>, <a href="k_scan.htm"><b><font color="#0000FF">Scan</font></b></a>, <a href="k_force.htm"><b><font color="#0000FF">Force</font></b></a>, <a href="k_freq.htm"><b><font color="#0000FF">Frequency</font></b></a></p>
<h3><font size="-1" color="#222222">EXAMPLES</font></h3>
<p><b>Output from Optimization Jobs</b>. The string <font face="Courier New, Courier, monospace" size="-1">GradGradGrad&hellip;</font> delimits the output from the Berny optimization procedures. On the first, initialization pass, the program prints a table giving the initial values of the variables to be optimized. For optimizations in redundant internal coordinates, <font face="Times New Roman, Times, serif" size="3"><i>all</i></font> coordinates in use are displayed in the table (not merely those present in the molecule specification section):</p>
<pre>
 GradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGrad
 Berny optimization.     <font face="Times New Roman, Times, serif" color="#CC0000"><i>The opt. algorithm is identified by the header format &amp; this line.</i></font></font>
 Initialization pass.
                   ----------------------------
                   !    Initial Parameters    !
                   ! (Angstroms and Degrees)  !
--------------------                          ----------------------
! Name  Definition              Value          Derivative Info.    !
--------------------------------------------------------------------
! R1    R(2,1)                  1.             estimate D2E/DX2   !
! R2    R(3,1)                  1.             estimate D2E/DX2   !
! A1    A(2,1,3)              104.5            estimate D2E/DX2   !
--------------------------------------------------------------------
</pre>
<p>The manner in which the initial second derivative are provided is indicated under the heading <b><font color="#0000FF">Derivative Info</font></b>. In this case the second derivatives will be estimated.</p>
<p>Each subsequent step of the optimization is delimited by lines like these:</p>
<pre>GradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGrad
Berny optimization.
Search for a local minimum.
Step number   4 out of a maximum of  20</pre>
<p>Once the optimization completes, the final structure is displayed:</p>
<pre>Optimization completed.
   -- Stationary point found.
                    ----------------------------
                    !   Optimized Parameters   !
                    ! (Angstroms and Degrees)  !
--------------------                            --------------------
! Name  Definition              Value          Derivative Info.    !
--------------------------------------------------------------------
! R1    R(2,1)                  0.9892         -DE/DX =    0.0002 !
! R2    R(3,1)                  0.9892         -DE/DX =    0.0002 !
! A1    A(2,1,3)              100.004          -DE/DX =    0.0001 !
--------------------------------------------------------------------</pre>
<p>The redundant internal coordinate definitions are given in the second column of the table. The numbers in parentheses refer to the atoms within the molecule specification. For example, the variable <b><font color="#0000FF">R1</font></b>, defined as <b><font color="#0000FF">R(2,1)</font></b>, specifies the bond length between atoms 1 and 2. The energy for the optimized structure will be found in the output from the final optimization step, which <font face="Times New Roman, Times, serif" size="3"><i>precedes</i></font> this table in the output file.</p>
<p><b>Compound Jobs</b>. Optimizations are commonly followed by frequency calculations at the optimized structure. To facilitate this procedure, the <a href="k_opt.htm"><b><font color="#0000FF">Opt</font></b></a> keyword may be combined with <a href="k_freq.htm"><b><font color="#0000FF">Freq</font></b></a> in the route section of an input file, and this combination will automatically generate a two-step job.</p>
<p>It is also common to follow an optimization with a single point energy calculation at a higher level of theory. The following route section automatically performs an HF/6-31G(d,p) optimization followed by an MP4/6-31G(d,p) single point energy calculation :</p>
<pre># MP4/6-31G(d,p)//HF/6-31G(d,p) Test</pre>
<p>Note that the <a href="k_opt.htm"><b><font color="#0000FF">Opt</font></b></a> keyword is not required in this case. However, it may be included if setting any of its options is desired.</p>
<p><b>Modifying Redundant Internal Coordinates</b>. The following input file illustrates the method for modifying redundant internal coordinates within an input file:</p>
<pre>
# HF/6-31G(d) Opt=ModRedun Test

Opt job

0,1
C1  0.000   0.000   0.000
C2  0.000   0.000   1.505
O3  1.047   0.000  -0.651
H4 -1.000  -0.006  -0.484
H5 -0.735   0.755   1.898
H6 -0.295  -1.024   1.866
O7  1.242   0.364   2.065
H8  1.938  -0.001   1.499

3  8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Adds hydrogen bond (but not angles or dihedrals).</i></font></font>
2  1  3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Adds C-C-O angle.</i></font></font>
</pre>
<p>This structure is acetaldehyde with an OH substituted for one of the hydrogens in the methyl group; the first input line for <b><font color="#0000FF">ModRedundant</font></b> creates a hydrogen bond between that hydrogen atom and the oxygen atom in the carbonyl group. Note that this adds only the bond between these two atoms The associated angles and dihedral angles could be added as well using the <b><font color="#0000FF">B</font></b> action code:</p>
<pre>
3  8  B
</pre>
<p><b>Displaying the Value of a Desired Coordinate</b>. The second input line for <b><font color="#0000FF">ModRedundant</font></b> specifies the C-C=O bond angle, ensuring that its value will be displayed in the summary structure table for each optimization step.</p>
<p><b>Using Wildcards in Redundant Internal Coordinates</b>. A distance matrix coordinate system can be activated using the following input:</p>
<pre>
* * B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Define all bonds between pairs of atoms</i></font></font>
* * * K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Remove all other redundant internal coordinates</i></font></font>
</pre>
<p>The following input defines partial distance matrix coordinates to connect only the closest layers of atoms:</p>
<pre>
* * B 1.1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Define all bonds between atoms within 1.1 &Aring;</i></font></font>
* * * K &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Remove all other redundant internal coordinates</i></font></font>
</pre>
<p>The following input sets up an optimization in redundant internal coordinates in which atoms <b><font color="#0000FF">N1</font></b> through <b><font color="#0000FF">Nn</font></b> are frozen (such jobs may require the <a href="k_symmetry.htm"><b><font color="#0000FF">NoSymm</font></b></a> keyword). Note that the lines containing the <b><font color="#0000FF">B</font></b> action code will generate Cartesian coordinates for all of the coordinates involving the specified atom since only one atom number is specified:</p>
<pre>
N1 B &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Generate Cartesian coordinates involving atom N1</i></font></font>
&hellip;
Nn B &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Generate Cartesian coordinates involving atom Nn</i></font></font>
* F &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Freeze all Cartesian coordinates</i></font></font>
</pre>
<p>The following input defines special &ldquo;spherical&rdquo; internal coordinates appropriate for molecules like C<sub>60</sub> by removing all dihedral angles from the redundant internal coordinates:</p>
<pre>
* * * * R &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Remove all dihedral angles</i></font></font></pre>
<p>Additional examples are found in the section on relaxed PES scans below.</p>
<p><b>Performing Partial Optimizations</b>. The following job illustrates the method for freezing variables during an optimization:</p>
<pre>
# B3LYP/6-31G(d) Opt=ReadOpt 

Partial optimization of Fe2S2
cluster with phenylthiolates.

-2,1
Fe 15.2630 -1.0091  7.0068
S  14.8495  1.1490  7.0431
Fe 17.0430  1.0091  7.0068
S  17.4565 -1.1490  7.0431
S  14.3762 -2.1581  8.7983
C  12.5993 -2.1848  8.6878
&hellip;
C  14.8285 -3.8823  3.3884
H  14.3660 -3.3149  2.7071

noatoms atoms=1-4 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>ReadOpt input.</i></font>
</pre>
<p>The central cluster (the first four atoms) will be optimized while the phenylthiolates are frozen.</p>
<p><b>Restarting an Optimization</b>. A failed optimization may be restarted from its checkpoint file by simply repeating the route section of the original job, adding the <a href="k_restart.htm"><b><font color="#0000FF">Restart</font></b></a> option to the <a href="k_opt.htm"><b><font color="#0000FF">Opt </font></b></a>keyword. For example, this route section restarts a B3LYP/6-31G(d) Berny optimization to a second-order saddle point:</p>
<pre>
%Chk=saddle2
# Opt=(TS,Restart,MaxCyc=50) Test</pre>
<p>The model chemistry and starting geometry are retrieved from the checkpoint file. Options specifying the optimization type and procedure are required in the route section for the restart job (e.g., <b><font color="#0000FF">TS</font></b> in the preceding example). Some parameter-setting options can be omitted to use the same values are for the original job, or they can be modified for the restarted job, such as <b><font color="#0000FF">MaxCycle</font></b> in the example. Note that you must include <b><font color="#0000FF">CalcFC</font></b> to compute the Hessian at the first point of the restarted job. Second derivatives are computed only when this option is present in the route section of the restarted job, regardless of whether it was specified for the original job.</p>
<p><b>Reading a Structure from the Checkpoint File</b>. Redundant internal coordinate structures may be retrieved from the checkpoint file with <a href="k_geom.htm"><b><font color="#0000FF">Geom=Checkpoint</font></b></a> as usual. The read-in structure may be altered by specifying <a href="k_geom.htm"><b><font color="#0000FF">Geom=ModRedundant</font></b></a> as well; modifications have a form identical to the input for <a href="k_opt.htm"><b><font color="#0000FF">Opt=ModRedundant</font></b></a>:</p>
<p>[<font face="Times New Roman, Times, serif" size="3"><i>Type</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>1 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>2 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>3 [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>4]]]&nbsp;[<font face="Times New Roman, Times, serif" size="3"><i>Action</i></font> [<font face="Times New Roman, Times, serif" size="3"><i>Params</i></font>]]&nbsp;[[<font face="Times New Roman, Times, serif" size="3"><i>Min</i></font>] <font face="Times New Roman, Times, serif" size="3"><i>Max</i></font>]]</p>
<p><b>Locating a Transition Structure with the STQN Method</b>. The <b><font color="#0000FF">QST2</font></b> option initiates a search for a transition structure connecting specific reactants and products. The input for this option has this general structure (blank lines are omitted):</p>
<table border="0">
  <tr valign="top">
    <td align="left"><font face="Courier New, Courier, monospace" size="-1"># HF/6-31G(d) Opt=QST2</font></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"><font face="Courier New, Courier, monospace" size="-1"># HF/6-31G(d) (Opt=QST2,ModRedun)</font></td>
  </tr>
  <tr valign="top">
    <td align="left"><font face="Times New Roman, Times, serif" size="3"><i>First title section</i></font></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"><font face="Times New Roman, Times, serif" size="3"><i>First title section</i></font></td>
  </tr>
  <tr valign="top">
    <td align="left"><font face="Times New Roman, Times, serif" size="3"><i>Molecule specification for the reactants</i></font></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"><font face="Times New Roman, Times, serif" size="3"><i>Molecule specification for the reactants</i></font></td>
  </tr>
  <tr valign="top">
    <td align="left"><font face="Times New Roman, Times, serif" size="3"><i>Second title section</i></font></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"><font face="Times New Roman, Times, serif" size="3"><i>ModRedundant input for the reactants</i></font></td>
  </tr>
  <tr valign="top">
    <td align="left"><font face="Times New Roman, Times, serif" size="3"><i>Molecule specification for the products</i></font></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"><font face="Times New Roman, Times, serif" size="3"><i>Second title section</i></font></td>
  </tr>
  <tr valign="top">
    <td align="left"></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"><font face="Times New Roman, Times, serif" size="3"><i>Molecule specification for the products</i></font></td>
  </tr>
  <tr valign="top">
    <td align="left"></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"></td>
    <td><font face="Times New Roman, Times, serif" color="#CC0000"><i><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></i></font></td>
    <td align="left"><font face="Times New Roman, Times, serif" size="3"><i>ModRedundant input for the products (optional)</i></font></td>
  </tr>
</table>
<p>Note that each molecule specification is preceded by its own title section (and separating blank line). If the <b><font color="#0000FF">ModRedundant</font></b> option is specified, then each molecule specification is followed by any desired modifications to the redundant internal coordinates.</p>
<p>Gaussian will automatically generate a starting structure for the transition structure midway between the reactant and product structures, and then perform an optimization to a first-order saddle point.</p>
<p>The <b><font color="#0000FF">QST3</font></b> option allows you to specify a better initial structure for the transition state. It requires the two title and molecule specification sections for the reactants and products as for <b><font color="#0000FF">QST2</font></b> and also additional, third title and molecule specification sections for the initial transition state geometry (along with the usual blank line separators), as well as three corresponding modifications to the redundant internal coordinates if the <b><font color="#0000FF">ModRedundant</font></b> option is specified. The program will then locate the transition structure connecting the reactants and products closest to the specified initial geometry.</p>
<p>The optimized structure found by <b><font color="#0000FF">QST2</font></b> or <b><font color="#0000FF">QST3</font></b> appears in the output in a format similar to that for other types of geometry optimizations:</p>
<pre>
                    ----------------------------
                    !   Optimized Parameters   !
                    ! (Angstroms and Degrees)  !
---------------------                          ----------------------
! Name  Definition    Value    Reactant  Product  Derivative Info.  !
-------------------------------------------------------------------
! R1    R(2,1)        1.0836    1.083     1.084    -DE/DX =    0.  !
! R2    R(3,1)        1.4233    1.4047    1.4426   -DE/DX =   -0.   !
! R3    R(4,1)        1.4154    1.4347    1.3952   -DE/DX =   -0.   !
! R4    R(5,3)        1.3989    1.3989    1.3984   -DE/DX =    0.   !
! R5    R(6,3)        1.1009    1.0985    1.0995   -DE/DX =    0.   !
! &hellip;                                                              !
-------------------------------------------------------------------
</pre>
<p>In addition to listing the optimized values, the table includes those for the reactants and products.</p>
<p><b>Performing a Relaxed Potential Energy Surface Scan</b>. The <a href="k_opt.htm"><b><font color="#0000FF">Opt=ModRedundant</font></b></a> option may also be used to perform a relaxed potential energy surface (PES) scan. Like the facility provided by <a href="k_scan.htm"><b><font color="#0000FF">Scan</font></b></a>, a relaxed PES scan steps over a rectangular grid on the PES involving selected internal coordinates. It differs from <a href="k_scan.htm"><b><font color="#0000FF">Scan</font></b></a> in that a constrained geometry optimization is performed at each point.</p>
<p>Relaxed PES scans are available only for the Berny algorithm. If any scanning variable breaks symmetry during the calculation, then you must include <a href="k_symmetry.htm"><b><font color="#0000FF">NoSymm</font></b></a> in the route section of the job, since it may fail with an error.</p>
<p>Redundant internal coordinates specified with the <a href="k_opt.htm"><b><font color="#0000FF">Opt=ModRedundant</font></b></a> option may be scanned using the <b><font color="#0000FF">S</font></b> code letter: <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>1 <font face="Times New Roman, Times, serif" size="3"><i>N</i></font>2  [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>3  [<font face="Times New Roman, Times, serif" size="3"><i>N</i></font>4]]  <b><font color="#0000FF">S</font></b> <font face="Times New Roman, Times, serif" size="3"><i>steps  step-size</i></font>. For example, this input adds a bond between atoms 2 and 3,   specifying three scan steps of 0.05 &Aring; each:</p>
<pre>2 3 S 3 0.05</pre>
<p>Wildcards in the <b><font color="#0000FF">ModRedundant</font></b> input may also be useful in setting up relaxed PES scans. For example, the following input is appropriate for a potential energy surface scan involving the N1-N2-N3-N4 dihedral angle:</p>
<pre>
N1 N2 N3 N4 S 20 2.0&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Specify a relaxed PES scan of 20 steps in 2&deg; increments</i></font></font>
</pre>
<p>Cartesian coordinates can also include scan specifications:</p>
<pre>
X <font face="Times New Roman, Times, serif" size="3"><i>atom</i></font> S <font face="Times New Roman, Times, serif" size="3"><i>x-steps</i></font> <font face="Times New Roman, Times, serif" size="3"><i>x-size</i></font> <font face="Times New Roman, Times, serif" size="3"><i>y-steps</i></font> <font face="Times New Roman, Times, serif" size="3"><i>y-size</i></font> <font face="Times New Roman, Times, serif" size="3"><i>z-steps</i></font> <font face="Times New Roman, Times, serif" size="3"><i>z-size</i></font>
</pre>
<p>For example, the following <b><font color="#0000FF">ModRedundant</font></b> input performs a relaxed potential energy surface scan. Starting at the initial position of atom 1 and moving in five 0.2 Angstrom steps in the X direction and three 0.1 Angstrom steps in the Z direction:</p>
<pre>
X 1 S 5 0.2 0 0.0 3 0.1
</pre>
<h3><font size="-1" color="#222222">THE BERNY OPTIMIZATION ALGORITHM</font></h3>
<p>The Berny geometry optimization algorithm in Gaussian is based on an earlier program written by H. B. Schlegel which implemented his
  published algorithm <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Schlegel82" class="showTip Schlegel82">Schlegel82</a>]</font>. The program has been considerably enhanced since this earlier version using techniques either taken from other algorithms or never published, and consequently it is appropriate to summarize the current status of the Berny algorithm here.</p>
<p>At each step of a Berny optimization the following actions are taken:</p>
<ul>
  <li>
    <p>The Hessian is updated unless an analytic Hessian has been computed or it is the first step, in which case an estimate of the Hessian is made. Normally the update is done using an iterated BFGS for minima and an iterated Bofill for transition states in redundant internal coordinates, and using a modification of the original Schlegel update procedure for optimizations in internal coordinates. By default, this is derived from a valence force field <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Schlegel84a" class="showTip Schlegel84a">Schlegel84a</a>]</font>, but upon request either a unit matrix or a diagonal Hessian can also be generated as estimates.</p>
  </li>
  <li>
    <p>The trust radius (maximum allowed Newton-Raphson step) is updated if a minimum is sought, using the method of Fletcher <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Fletcher80" class="showTip Fletcher80">Fletcher80</a>, <a href="refs.htm#Bofill94" class="showTip Bofill94">Bofill94</a>, <a href="refs.htm#Bofill95" class="showTip Bofill95">Bofill95</a>]</font>.</p>
  </li>
  <li>
    <p>Any components of the gradient vector corresponding to frozen variables are set to zero or projected out, thereby eliminating their direct contribution to the next optimization step.</p>
    <p>If a minimum is sought, perform a linear search between the latest point and the best previous point (the previous point having lowest energy). If second derivatives are available at both points and a minimum is sought, a quintic polynomial fit is attempted first; if it does not have a minimum in the acceptable range (see below) or if second derivatives are not available, a constrained quartic fit is attempted. This fits a quartic polynomial to the energy and first derivative (along the connecting line) at the two points with the constraint that the second derivative of the polynomial just reach zero at its minimum, thereby ensuring that the polynomial itself has exactly one minimum. If this fit fails or if the resulting step is unacceptable, a simple cubic is fit is done.</p>
    <p>Any quintic or quartic step is considered acceptable if the latest point is the best so far but if the newest point is not the best, the linear search must return a point in between the most recent and the best step to be acceptable. Cubic steps are never accepted unless they are in between the two points or no larger than the previous step. Finally, if all fits fail and the most recent step is the best so far, no linear step is taken. If all fits fail and the most recent step is not the best, the linear step is taken to the midpoint of the line connecting the most recent and the best previous points.</p>
  </li>
  <li>
    <p>If the latest point is the best so far or if a transition state is sought, a quadratic step is determined using the current (possibly approximate) second derivatives. If a linear search was done, the quadratic step is taken from the point extrapolated using the linear search and uses forces at that point estimated by interpolating between the forces at the two points used in the linear search. By default, this step uses the Rational Function Optimization (RFO) approach <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Simons83" class="showTip Simons83">Simons83</a>, <a href="refs.htm#Banerjee85" class="showTip Banerjee85">Banerjee85</a>, <a href="refs.htm#Baker86" class="showTip Baker86">Baker86</a>, <a href="refs.htm#Baker87" class="showTip Baker87">Baker87</a>]</font>. The RFO step behaves better than the Newton-Raphson method used in earlier versions of Gaussian when the curvature at the current point is not that desired. The old Newton-Raphson step is available as an option.</p>
  </li>
  <li>
    <p>Any components of the step vector resulting from the quadratic step corresponding to frozen variables are set to zero or projected out.</p>
  </li>
  <li>
    <p>If the quadratic step exceeds the trust radius and a minimum is sought, the step is reduced in length to the trust radius by searching for a minimum of the quadratic function on the sphere having the trust radius, as discussed by J&oslash;rgensen <font face="Arial, Helvetica, sans-serif" size="-2">[<a href="refs.htm#Golab83" class="showTip Golab83">Golab83</a>]</font>. If a transition state is sought or if <b><font color="#0000FF">NRScale</font></b> was requested, the quadratic step is simply scaled down to the trust radius. </p>
  </li>
  <li>
    <p>Finally, convergence is tested against criteria for the maximum force component, root-mean square force, maximum step component, and root-mean-square step. The step is the change between the most recent point and the next to be computed (the sum of the linear and quadratic steps).</p>
  </li>
</ul>
<p>&nbsp;</p>
<hr />
<p class="upd">Last update: 22 May 2014</p>  

</body></html>
