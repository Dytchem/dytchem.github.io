<html><head><title>The cubegen Utility</title></head><body>

<h1>cubegen</h1>
<p>Gaussian includes a standalone utility for generating cubes from the data in a formatted checkpoint file (equivalent to the previous <font color="#009933">Cube</font> keyword). The utility is named <a href="u_cubegen.htm"><b><font color="#0000FF">cubegen</font></b></a>, and it has the following syntax:</p>
<p><a href="u_cubegen.htm"><b><font color="#0000FF">cubegen</font></b></a>  <font face="Times New Roman, Times, serif" size="3"><i>nprocs  kind  fchkfile  cubefile  npts  format</i></font> <em>cubefile2</em></p>
<p>The parameters, which are not case-sensitive, have the following meanings:</p>
<p><b><font color="#0000FF"><font face="Times New Roman, Times, serif" size="3"><i>nprocs</i></font></font></b><br />
Number of shared memory processors used for electrostatic potential calculations. A value of 0 is equivalent to 1 (it is the default). Note that this parameter must be included if other parameters are specified. Previously this parameter was used to specify the amount of memory to allocate. The <font color="#009933">GAUSS_MEMDEF</font> environment variable should be used instead.
</p>
<p><b><font color="#0000FF"><font face="Times New Roman, Times, serif" size="3"><i>kind</i></font></font></b><br />
A keyword specifying the type of cube to generate:
<table border="0" cellpadding="2">
<tr valign="top"><td><b><font color="#0000FF">MO=</font></b><font face="Times New Roman, Times, serif" size="3"><i>n</i></font></td><td>&nbsp;&nbsp;</td>
<td>Molecular orbital <font face="Times New Roman, Times, serif" size="3"><i>n</i></font>. The keywords <b><font color="#0000FF">Homo</font></b>, <b><font color="#0000FF">Lumo</font></b>, <b><font color="#0000FF">All</font></b>, <b><font color="#0000FF">OccA</font></b> (all alpha occupied), <b><font color="#0000FF">OccB</font></b> (all beta occupied), <b><font color="#0000FF">Valence</font></b> (all valence orbitals) and <b><font color="#0000FF">Virtuals</font></b> (all virtual orbitals) may also be used in place of a specific orbital number. There is no default for <font face="Times New Roman, Times, serif" size="3"><i>n</i></font>, and an error will occur if it is omitted. <b><font color="#0000FF">AMO</font></b> and <b><font color="#0000FF">BMO</font></b> can be similarly used to select only alpha or beta orbitals (respectively). For open shell systems, <b><font color="#0000FF">Homo</font></b> selects both alpha and beta orbitals.</td>
<tr valign="top"><td><a href="k_density.htm"><b><font color="#0000FF">Density=</font></b></a><font face="Times New Roman, Times, serif" size="3"><i>type</i></font></td><td>&nbsp;&nbsp;</td>
<td>Total density of the specified type. The <font face="Times New Roman, Times, serif" size="3"><i>type</i></font> keyword is one of the single density selection options that are valid with the <a href="k_density.htm"><b><font color="#0000FF">Density</font></b></a> keyword: <a href="k_scf.htm"><b><font color="#0000FF">SCF</font></b></a>, <a href="k_mp.htm"><b><font color="#0000FF">MP2</font></b></a>, <a href="k_cid.htm"><b><font color="#0000FF">CI</font></b></a>, <b><font color="#0000FF">QCI,</font></b> and so on (note that <font color="#009933">Current</font> is not supported). The <b><font color="#0000FF">FDensity=</font></b> variation requests the use of the full instead of the frozen core density. The default <font face="Times New Roman, Times, serif" size="3"><i>type</i></font> keyword is <a href="k_scf.htm"><b><font color="#0000FF">SCF</font></b></a>.</td>
<tr valign="top"><td><b><font color="#0000FF">Spin=</font></b><font face="Times New Roman, Times, serif" size="3"><i>type</i></font></td><td>&nbsp;&nbsp;</td>
<td>Spin density (difference between &alpha; and &beta; densities) of the specified type.</td>
<tr valign="top"><td><b><font color="#0000FF">Alpha=</font></b><font face="Times New Roman, Times, serif" size="3"><i>type</i></font></td><td>&nbsp;&nbsp;</td>
<td>Alpha spin density of the specified type. <b><font color="#0000FF">FAlpha=</font></b> requests the use of the full instead of the frozen core density.</td>
<tr valign="top"><td><b><font color="#0000FF">Beta=</font></b><font face="Times New Roman, Times, serif" size="3"><i>type</i></font></td><td>&nbsp;&nbsp;</td>
<td>Beta spin density of the specified type. <b><font color="#0000FF">FBeta=</font></b> requests the use of the full instead of the frozen core density.</td>
<tr valign="top"><td><b><font color="#0000FF">Potential=</font></b><font face="Times New Roman, Times, serif" size="3"><i>type</i></font></td><td>&nbsp;&nbsp;</td>
<td>Electrostatic potential using the density of the specified type.</td>
<tr valign="top"><td><b><font color="#0000FF">Gradient</font></b></td><td>&nbsp;&nbsp;</td>
<td>Compute the density and gradient.</td>
<tr valign="top"><td><b><font color="#0000FF">Laplacian</font></b></td><td>&nbsp;&nbsp;</td>
<td>Compute the Laplacian of the density (&nabla;<sup>2</sup>&rho;).</td>
<tr valign="top"><td><b><font color="#0000FF">NormGradient</font></b></td><td>&nbsp;&nbsp;</td>
<td>Compute the norm of the density gradient at each point.</td>
<tr valign="top"><td><b><font color="#0000FF">CurrentDensity=</font></b><font face="Times New Roman, Times, serif" size="3"><i>I</i></font></td><td>&nbsp;&nbsp;</td>
<td>Magnitude of the magnetically-induced (GIAO) current density, where <font face="Times New Roman, Times, serif" size="3"><i>I</i></font> is the applied magnetic field direction (X, Y or Z).</td>
<tr valign="top"><td><b><font color="#0000FF">ShieldingDensity=</font></b><font face="Times New Roman, Times, serif" size="3"><i>IJN</i></font></td><td>&nbsp;&nbsp;</td>
<td>Magnetic shielding densit}. <font face="Times New Roman, Times, serif" size="3"><i>I</i></font> is the direction of the applied magnetic field, <font face="Times New Roman, Times, serif" size="3"><i>J</i></font> is the direction of the induced field (X, Y or Z), and <font face="Times New Roman, Times, serif" size="3"><i>N</i></font> is the number of the nucleus for which the shielding density (GIAO) is to be calculated.</td>
</table>
</p>
<p><b><font color="#0000FF"><font face="Times New Roman, Times, serif" size="3"><i>fchkfile</i></font></font></b><br />
Name of the formatted checkpoint file. <a href="u_cubegen.htm"><b><font color="#0000FF">cubegen</font></b></a> will prompt for this filename if it is not specified.
</p>
<p><b><font color="#0000FF"><font face="Times New Roman, Times, serif" size="3"><i>cubefile</i></font></font></b><br />
Name of the output cube file; <font color="#009933">test.cube</font> is the default if it is not explicitly specified (i.e., specifying the name of the checkpoint file does not change the default cube filename).
</p>
<p><b><font color="#0000FF"><font face="Times New Roman, Times, serif" size="3"><i>npts</i></font></font></b><br />
Number of points per side in the cube. A value of <b><font color="#0000FF">0</font></b> selects the default value of 80<sup>3</sup> points distributed evenly over a rectangular grid generated automatically by the program (not necessarily a cube). Positive values of <font face="Times New Roman, Times, serif" size="3"><i>npts</i></font> similarly specify the number of points per &ldquo;side&rdquo;; e.g., 100 specified a grid of 1,000,000 (100<sup>3</sup>) points.
<br /><br />The values <b><font color="#0000FF">-2</font></b>, <b><font color="#0000FF">-3</font></b> and <b><font color="#0000FF">-4</font></b> correspond to the keywords <b><font color="#0000FF">Coarse</font></b>, <b><font color="#0000FF">Medium</font></b> and <b><font color="#0000FF">Fine</font></b> and to values of 3 points/Bohr, 6 points/Bohr and 12 points/Bohr (respectively). Negative values of <font face="Times New Roman, Times, serif" size="3"><i>npts</i></font> &le;-5 specify spacing of <font face="Times New Roman, Times, serif" size="3"><i>npts</i></font>*10<sup>-3</sup> Angstroms between points in the grid.
<br /><br />A value of <b><font color="#0000FF">-1</font></b> says to read the cube specification from the input stream, according to the following format:
<table border="0">
<tr valign="top"><td align="left"><font face="Times New Roman, Times, serif" size="3"><i>IFlag, X</i></font><sub>0</sub>, <font face="Times New Roman, Times, serif" size="3"><i>Y</i></font><sub>0</sub>, <font face="Times New Roman, Times, serif" size="3"><i>Z</i></font><sub>0</sub></td><td align="left"><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Courier New, Courier, monospace" size="-1">&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="right"><font face="Times New Roman, Times, serif" size="3"><i>Output unit number and initial point.</i></font></td></tr>
<tr valign="top"><td align="left"><font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>1</sub>, <font face="Times New Roman, Times, serif" size="3"><i>X</i></font><sub>1</sub>, <font face="Times New Roman, Times, serif" size="3"><i>Y</i></font><sub>1</sub>, <font face="Times New Roman, Times, serif" size="3"><i>Z</i></font><sub>1</sub></td><td align="left"> </td><td align="right"><font face="Times New Roman, Times, serif" size="3"><i>Number of points and step-size in the X-direction.</i></font></td></tr>
<tr valign="top"><td align="left"><font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>2</sub>, <font face="Times New Roman, Times, serif" size="3"><i>X</i></font><sub>2</sub>, <font face="Times New Roman, Times, serif" size="3"><i>Y</i></font><sub>2</sub>, <font face="Times New Roman, Times, serif" size="3"><i>Z</i></font><sub>2</sub></td><td align="left"> </td><td align="right"><font face="Times New Roman, Times, serif" size="3"><i>Number of points and step-size in the Y-direction.</i></font></td></tr>
<tr valign="top"><td align="left"><font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub>, <font face="Times New Roman, Times, serif" size="3"><i>X</i></font><sub>3</sub>, <font face="Times New Roman, Times, serif" size="3"><i>Y</i></font><sub>3</sub>, <font face="Times New Roman, Times, serif" size="3"><i>Z</i></font><sub>3</sub></td><td align="left"> </td><td align="right"><font face="Times New Roman, Times, serif" size="3"><i>Number of points and step-size in the Z-direction.</i></font></td></tr>
</table>
<font face="Times New Roman, Times, serif" size="3"><i>IFlag</i></font> is the output unit number. If <font face="Times New Roman, Times, serif" size="3"><i>IFlag</i></font> is less than 0, then a formatted file will be produced; otherwise, an unformatted file will be written.
<br /><br />If <font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>1</sub>&lt;0 the input cube coordinates are assumed to be in Bohr, otherwise, they are interpreted as Angstroms. |<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>1</sub>| is used as the number of X-direction points in any case; <font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>2</sub> and <font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub> specify the number of points in the Y and Z directions, respectively. Note that the three axes are used exactly as specified; they are not orthogonalized, so the grid need not be rectangular.
<br /><br />The value <b><font color="#0000FF">-5</font></b> says to read in an arbitrary list of points from standard input. If you enter this input by hand, terminate the input with an end-of-file (i.e., <b><font color="#0000FF">Ctrl-D</font></b> under Unix). Alternatively, you can redirect standard input to a file containing the list of points (do not place a blank line or <b><font color="#0000FF">Ctrl-D</font></b> at the end of the file).
</p>
<p><b><font color="#0000FF"><font face="Times New Roman, Times, serif" size="3"><i>format</i></font></font></b><br />
Format of formatted output files: <b><font color="#0000FF">h</font></b> means include header (this is the default); <b><font color="#0000FF">n</font></b> means don&rsquo;t include header. This parameter is ignored when unformatted cube files are produced.
</p>
<p><b><i><font color="#0000FF" size="3" face="Times New Roman, Times, serif">cubefile2</font></i></b><br />
If specified, the size for the generated cube is taken from this file. This option is useful when creating cubes for later arithmetic operations such as difference densities where you need the exact same grid to be used for all cubes. In order for the cube dimensions to be taken from the specified cube file, the <em>npts</em> parameters must be -1 and the specified file must have been created with a header.</p>
<p>If no parameters are specified, <a href="u_cubegen.htm"><b><font color="#0000FF">cubegen</font></b></a> will prompt for <font face="Times New Roman, Times, serif" size="3"><i>fchkfile</i></font> and run the following:</p>
<p><a href="u_cubegen.htm"><b><font color="#0000FF">cubegen  1 density=scf</font></b></a> <b><font color="#0000FF">test.cube 80 h</font></b></p>
<p>This generates a file named <font color="#009933">test.cube</font> (with header) containing the SCF density in a rectangular grid of 80<sup>3</sup> points.</p>
<h3><font size="-1" color="#222222">OUTPUT FILE FORMATS</font></h3>
<p>All values in the cube file are in atomic units, regardless of the input units.</p>
<p>For density and potential grids, unformatted files have one row per record (i.e., <font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>1</sub>*<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>2</sub> records each of length <font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub>). For formatted output, each row is written out in format (6E13.5). In this case, if <font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub> is not a multiple of six, then there may be blank space in some lines.</p>
<p>The norm of the density gradient and the Laplacian are also scalar (i.e., one value per point), and are written out in the same manner. Density+Gradient grids are similar, but with two writes for each row (of lengths <font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub> and 3*<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub>). Density+Gradient+Laplacian grids have 3 writes per row (of lengths <font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub>, 3*<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub>, and <font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub>).</p>
<p>For example, for a density cube, the output file looks like this:</p>
<pre>
NAtoms, X-Origin, Y-Origin, Z-Origin NVal &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>NVal is the #points/value</i></font>
N1, X1, Y1, Z1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i># of increments in the slowest running direction</i></font></font>
N2, X2, Y2, Z2
N3, X3, Y3, Z3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i># of increments in the fastest running direction</i></font></font>
IA1, Chg1, X1, Y1, Z1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Atomic number, charge, and coordinates of the first atom</i></font></font>
&hellip;
IAn, Chgn, Xn, Yn, Zn &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Atomic number, charge, and coordinates of the last atom</i></font></font>
<font face="Times New Roman, Times, serif"><i>(N1*N2) records, each of length N3</i></font></font> &nbsp;&nbsp;&nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Values of the density at each point in the grid</i></font></font>
</pre>
<p>Note that a separate write is used for each record.</p>
<p>For molecular orbital output, <font face="Times New Roman, Times, serif" size="3"><i>NAtoms</i></font> will be less than zero, and an additional record follows the data for the final atom (in format 10I5 if the file is formatted):</p>
<pre>
NMO, (MO(I),I=1,NMO) &nbsp;&nbsp;<font face="Times New Roman, Times, serif" color="#CC0000"><i>Number of MOs and their numbers</i></font></font>
</pre>
<p>If <font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>MO</sub> orbitals were evaluated, then each record is <font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>MO</sub>*<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub> long and has the values for all orbitals at each point together.</p>
<h3><font size="-1" color="#222222">READING CUBE FILES WITH FORTRAN PROGRAMS</font></h3>
<p>If one wishes to read the values of the density, Laplacian, or potential back into an array dimensioned X(<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub>,<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>2</sub>,<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>1</sub>), code like the following Fortran loop may be used:</p>
<pre>
      Do 10 I1 = 1, N1
      Do 10 I2 = 1, N2
         Read(n,'(6E13.5)') (X(I3,I2,I1),I3=1,N3)
      10 Continue
</pre>
<p>where <font face="Times New Roman, Times, serif" size="3"><i>n</i></font> is the unit number corresponding to the cube file.</p>
<p>If the origin is (X<sub>0</sub>,Y<sub>0</sub>,Z<sub>0</sub>), and the increment is (X<sub>1</sub>,Y<sub>1</sub>,Z<sub>1</sub>), then point (I<sub>1</sub>,I<sub>2</sub>,I<sub>3</sub>) has the coordinates:</p>
<p><font face="Times New Roman, Times, serif" size="3"><i>X-coordinate:</i></font> X<sub>0</sub>+(I<sub>1</sub>-1)*X<sub>1</sub>+(I<sub>2</sub>-1)*X<sub>2</sub>+(I<sub>3</sub>-1)*X<sub>3</sub></p>
<p><font face="Times New Roman, Times, serif" size="3"><i>Y-coordinate:</i></font> Y<sub>0</sub>+(I<sub>1</sub>-1)*Y<sub>1</sub>+(I<sub>2</sub>-1)*Y<sub>2</sub>+(I<sub>3</sub>-1)*Y<sub>3</sub></p>
<p><font face="Times New Roman, Times, serif" size="3"><i>Z-coordinate:</i></font> Z<sub>0</sub>+(I<sub>1</sub>-1)*Z<sub>1</sub>+(I<sub>2</sub>-1)*Z<sub>2</sub>+(I<sub>3</sub>-1)*Z<sub>3</sub></p>
<p>The output is similar if the gradient or gradient and Laplacian of the charge density are also requested, except that in these cases there are two or three records, respectively, written for each pair of I<sub>1</sub>, I<sub>2</sub> values. Thus, if the density and gradient are to be read into arrays D(<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub>,<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>2</sub>,<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>1</sub>), G(3,<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub>,<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>2</sub>,<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>1</sub>), RL(<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>3</sub>,<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>2</sub>,<font face="Times New Roman, Times, serif" size="3"><i>N</i></font><sub>1</sub>), a correct set of Fortran loops would be:</p>
<pre>
      Do 10 I1 = 1, N1
      Do 10 I2 = 1, N2
         Read(n,'(6F13.5)')  (D(I3,I2,I1),I3=1,N3)
         Read(n,'(6F13.5)')  ((G(IXYZ,I3,I2,I1),IXYZ=1,3), I3=1,N3)
 10   Continue
</pre>
<p>where again <font face="Times New Roman, Times, serif" size="3"><i>n</i></font> is the unit number corresponding to the cube file.</p>
<p>&nbsp;</p>
<hr />
<p class="upd">Last update: 3 November 2014</p>

</body></html>
